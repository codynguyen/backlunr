(function(){var t=function(t,n){return function(){return t.apply(n,arguments)}},n={}.hasOwnProperty,r=function(t,r){function i(){this.constructor=t}for(var e in r)n.call(r,e)&&(t[e]=r[e])
return i.prototype=r.prototype,t.prototype=new i,t.__super__=r.prototype,t}
Backbone.Collection.Lunr=function(n){function i(n,r){this.search=t(this.search,this),this.processTerm=t(this.processTerm,this),this.reset=t(this.reset,this),this._lunrChange=t(this._lunrChange,this),this._lunrRemove=t(this._lunrRemove,this),this._lunrAdd=t(this._lunrAdd,this),this._lunrInitialize=t(this._lunrInitialize,this),i.__super__.constructor.call(this,n,r),this.on("add",this._lunrAdd),this.on("remove",this._lunrRemove),this.on("change",this._lunrChange)}return r(i,n),i.prototype.lunroptions={fields:[]},i.prototype._lunrInitialize=function(){var t
return t=this,t._lunrFields=[],this._lunrIndex=lunr(function(){var n,r,i,e,o
for(e=_.isFunction(t.lunroptions)?t.lunroptions(opt):_.extend({},t.lunroptions||(t.lunroptions={})),this.ref("cid"),o=e.fields,r=0,i=o.length;i>r;r++)n=o[r],t._lunrFields.push(n.name),this.field(n.name,_.omit(n,["isID","name"]))})},i.prototype._lunrAdd=function(t){var n,r,i,e,o
for(e=t.toJSON(),e.cid=t.cid,o=this._lunrFields,r=0,i=o.length;i>r;r++)n=o[r],e[n]=null==e[n]?"":""+e[n]
this._lunrIndex.add(e)},i.prototype._lunrRemove=function(t){var n
n=t.toJSON(),n.cid=t.cid,this._lunrIndex.remove(n)},i.prototype._lunrChange=function(t){var n,r,i,e,o
for(e=t.toJSON(),e.cid=t.cid,o=this._lunrFields,r=0,i=o.length;i>r;r++)n=o[r],e[n]=null==e[n]?"":""+e[n]
this._lunrIndex.update(e)},i.prototype.reset=function(t,n){var r,e,o,s
for(this._lunrInitialize(),i.__super__.reset.call(this,t,n),s=this.models,e=0,o=s.length;o>e;e++)r=s[e],this._lunrAdd(r)
return this},i.prototype.processTerm=function(t){return t},i.prototype.search=function(t,n){var r,i,e,o
return null==n&&(n=!1),e=this._lunrIndex.search(this.processTerm(t)),n?e:(o=function(){var t,n,o
for(o=[],r=t=0,n=e.length;n>t;r=++t)i=e[r],o.push(this.get(i.ref))
return o}.call(this),o.toJSON=function(t){var n,r
return r=function(){var r,i,e
for(e=[],r=0,i=this.length;i>r;r++)n=this[r],e.push(n.toJSON(t))
return e}.call(this)},o)},i}(Backbone.Collection)}).call(this)